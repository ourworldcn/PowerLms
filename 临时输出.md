# 会议备忘录

**日期:** 2024-07-26
**主题:** PowerLms 系统功能评审与问题跟进

---

### 1. 🚀 项目总体进度与数据流程

- **当前状态**: 上周已完成两轮流程测试，核心目标是跑通完整数据流程。
- **后续计划**: 流程跑通后，由小周负责后续的用户培训和系统熟悉工作。
- **关键问题**: 基础资料的导入导出功能基本解决，仅剩一个“覆盖”问题待验证。

### 2. 🐛 Bug修复与功能优化

#### 2.1. 基础资料导入/导出

- **覆盖问题**:
    - **问题**: 导入时，“是否覆盖”选项不起作用。
    - **状态**: **已修复**。后端刚根据 `code` 进行了修改，待石永昌再次测试验证。
- **汇率导入**:
    - **问题**: 存在问题。
    - **决策**: 暂时注释掉该功能，后续处理。
- **港口导入**:
    - **问题**: 港口类别无法识别。
    - **状态**: **已修复**。现在可以正确识别并导入。

#### 2.2. 用户界面 (UI)

- **当前账期显示**:
    - **需求**: 在页面醒目位置显示当前机构的“当前账期”。
    - **方案**: 在机构名称后面显示，格式为 `当前账期：YYYY年MM月`。
    - **负责人**: 陈云霄。
- **样式选择器激活框**:
    - **问题**: 激活的输入框颜色太暗，不清晰。
    - **方案**: 加深颜色或更换颜色，以增强辨识度。
    - **负责人**: 陈云霄。
- **表单标题统一**:
    - **需求**: 将各页面弹窗中的“表单信息”标题，根据上下文改为更具体的名称，如“公众号信息”、“申请单信息”等。
    - **决策**: 这是一个低优先级任务，在修改相关页面时顺便处理。
    - **负责人**: 陈云霄。

#### 2.3. 用户与权限管理

- **新建用户机构必填**:
    - **问题**: 新建用户时不选择所属机构，用户保存后会“消失”，无法查找。
    - **方案**:
        1.  **前端**: 将“机构”字段设为必填项，强制用户选择。
        2.  **后端**: 作为补充，如果前端未传机构ID，后端将用户自动归属到当前商户下，确保用户不会丢失，且后续可被商管找到并修改。
    - **负责人**: 前端（陈云霄），后端（ZC@WorkGroup）。
- **账户检索增加管理员选项**:
    - **需求**: 在用户检索界面增加“是否管理员”的筛选条件。
    - **挑战**: 管理员状态是一个枚举位掩码（Flags Enum），直接在后端进行精确匹配查询比较困难。
    - **决策**: 此功能暂缓。目前可通过状态排序将管理员排在前面，基本满足查找需求。

#### 2.4. 工作号 (Job)

- **复制工作号**:
    - **需求**: 复制工作号时，不应复制“财务日期”。
    - **状态**: 待陈云霄确认是否已实现。
- **客户选择**:
    - **需求**: 在开工作号选择客户时，下拉列表只应显示“有效”状态的客户。
    - **状态**: 陈云霄已修改了一部分，但需注意处理已选了无效客户的旧数据。
- **港口/费用种类选择**:
    - **需求**:
        1.  选择目的港时，增加一列显示港口的中文名称。
        2.  增加费用时，费用种类下拉框支持按中文名称和简称进行模糊查询。
    - **负责人**: 陈云霄。

#### 2.5. 费用与账单

- **备用方案生成费用**:
    - **问题**: 从备用方案生成费用时，预览和提交后，费用名称丢失，只显示了编号。
    - **负责人**: 陈云霄，需排查问题。
- **新增账单合计金额**:
    - **问题**: 新增账单时，底部的合计金额有时显示，有时不显示。
    - **状态**: 这是一个偶发问题，待石永昌再次测试，如果复现则提供详细步骤。

#### 2.6. 审批流程

- **流程设计器位置**:
    - **问题**: 流程设计节点可能被拖动到容器外部（出现负坐标），导致看不见。
    - **方案**: 确保节点位置始终在容器内，或在保存时将其强制居中。
    - **负责人**: 陈云霄。
- **申请单编辑状态**:
    - **问题**: 申请单在特定状态下无法编辑。
    - **状态**: **已修复**。但涉及多种状态判断（如已提交后不能编辑），需要进行全面测试。
    - **负责人**: 石永昌（测试）。

### 3. 🏛️ 架构与核心功能

#### 3.1. 机构默认币种与信息维护

- **问题**: 商管在新建组织机构时，无法选择“本位币”，因为币种列表的来源不明确（是超管的、商户的还是某个机构的？）。
- **核心矛盾**: 新建机构时，该机构自身的币种信息还不存在，导致“鸡生蛋、蛋生鸡”的问题。
- **决策/新方案**:
    1.  **功能调整**: 商管创建机构时，不再需要填写所有详细信息（如本位币）。
    2.  **新增功能**: 创建一个名为“**本公司信息**”的独立功能模块/页面。
    3.  **权限分配**: 授权给财务等特定角色，允许他们在此页面编辑本机构的详细信息，如法人代表、营业执照号、开户行、财务设置以及**本位币**等。
    4.  **UI交互**: 该功能入口可以放在“设置”里，或者点击页面顶部的公司名称时弹出。它没有列表，是一个直接编辑当前机构信息的弹窗。
    5.  **锁定字段**: “显示名称”、“全名”、“架构类型”这三个字段由超管设定，不可在此页面修改。
- **收益**: 此方案解决了币种来源的混乱问题，并将信息维护权限下放给合适的角色。
- **负责人**: 陈云霄。

#### 3.2. Nginx 自动启动

- **问题**: 服务器重启后，Nginx 服务无法自动启动，但手动启动正常。
- **分析**: 可能是因为 Nginx 依赖的某个 Windows 服务尚未就绪。
- **方案**: 修改启动 Nginx 的 Windows 计划任务，为其增加 10-15 秒的延迟启动。
- **负责人**: 陈云霄。

#### 3.3. 权限缓存

- **状态**: 后端基础代码已修改完毕。
- **后续**: 如果再出现权限不生效的问题，需要记录问题现象和发生时间（例如，闲置多长时间后出现），以便排查是应用代码问题还是缓存问题。
- **负责人**: ZC@WorkGroup。

### 4. 🛠️ 协作与工具

- **Bug 跟踪**:
    - **提议**: 随着测试深入，Bug 数量可能增多，建议启用专业的 Bug 跟踪工具（如邮件系统、Azure DevOps, GitLab, Gitea 等），以便于图文并茂地描述问题，并进行流程化管理。
    - **当前问题**: 团队在使用微软 Azure DevOps 时遇到登录困难、网络慢、多账号冲突等问题。
    - **临时决策**: 暂时继续通过口头沟通和列表方式跟进。如果问题描述不清，会考虑使用邮件等方式附上截图。

---
**会议结论**: 下周将继续当前的 Bug 修复和功能验证工作，重点进入审批、结算、开票等核心流程的测试。同时，将开发“本公司信息”功能以解决机构信息维护的根本问题。
