# 会议备忘录 - 后端待办事项

**日期:** 2024-07-26
**主题:** PowerLms 系统功能评审与问题跟进（后端任务摘要）

---

### 1. 🐛 Bug修复与功能优化（后端相关）

#### 1.1. 用户与权限管理

- **账户检索增加管理员选项**:
    - **需求**: 在用户检索界面增加"是否管理员"的筛选条件。
    - **挑战**: 管理员状态是一个枚举位掩码（Flags Enum），直接在后端进行精确匹配查询比较困难。
    - **决策**: 此功能暂缓。目前可通过状态排序将管理员排在前面,基本满足查找需求。
    - **状态**: ✅ 已验证功能正常，无需修改

#### 1.2. 费用与账单

- **新增账单合计金额**:
    - **问题**: 新增账单时，底部的合计金额有时显示，有时不显示。
    - **状态**: 这是一个偶发问题，待石永昌再次测试，如果复现则提供详细步骤。

#### 1.3. 审批流程

- **申请单编辑状态**:
    - **问题**: 申请单在特定状态下无法编辑。
    - **状态**: **已修复**。但涉及多种状态判断（如已提交后不能编辑），需要进行全面测试。
    - **负责人**: 石永昌（测试）。

### 2. 🏛️ 架构与核心功能

#### 2.1. 机构默认币种与信息维护

- **问题**: 商管在新建组织机构时，无法选择"本位币"，因为币种列表的来源不明确（是超管的、商户的还是某个机构的？）。
- **核心矛盾**: 新建机构时，该机构自身的币种信息还不存在，导致"鸡生蛋、蛋生鸡"的问题。
- **决策/新方案**:
    1.  **功能调整**: 商管创建机构时，不再需要填写所有详细信息（如本位币）。
    2.  **新增功能**: 创建一个名为"**本公司信息**"的独立功能模块/页面。
    3.  **权限分配**: 授权给财务等特定角色，允许他们在此页面编辑本机构的详细信息，如法人代表、营业执照号、开户行、财务设置以及**本位币**等。
    4.  **UI交互**: 该功能入口可以放在"设置"里，或者点击页面顶部的公司名称时弹出。它没有列表，是一个直接编辑当前机构信息的弹窗。
    5.  **锁定字段**: "显示名称"、"全名"、"架构类型"这三个字段由超管设定，不可在此页面修改。
- **收益**: 此方案解决了币种来源的混乱问题，并将信息维护权限下放给合适的角色。
- **负责人**: 后端接口开发 - ZC@WorkGroup，前端页面 - 陈云霄。
- **接口设计**：
    - `GET /api/Organization/GetCurrentOrganizationInfo` - 获取当前机构信息
    - `PUT /api/Organization/UpdateCurrentOrganizationInfo` - 更新当前机构信息

#### 2.2. 权限缓存

- **状态**: 后端基础代码已修改完毕。
- **后续**: 如果再出现权限不生效的问题，需要记录问题现象和发生时间（例如，闲置多长时间后出现），以便排查是应用代码问题还是缓存问题。
- **负责人**: ZC@WorkGroup。

---
**会议结论**: 下周将继续当前的 Bug 修复和功能验证工作，重点进入审批、结算、开票等核心流程的测试。同时，将开发"本公司信息"功能以解决机构信息维护的根本问题。
