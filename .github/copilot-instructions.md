# 企业级 .NET 6 项目开发规范

## 基础设定
- 答复用简体中文，技术词保留英文
- 基于 .NET 6 与 C# 10，优先使用新特性提升代码简洁性
- 架构分层：API→Server(Manager)→Data→基础设施
- 业务逻辑归Manager类，控制器只做校验和异常处理

## 编程约束
- **禁止项**：EF Core实体用record类型；非真实I/O场景滥用async/await
- **必需项**：风格统一，命名规范；新特性需兼容现有架构；本地函数集中文件末尾用#region分组
- **#region规范**：所有 `#region [标题]` 必须有对应的 `#endregion [标题]`，嵌套需正确缩进

## 质量与安全
- 优先复用，减少重复；Manager抛业务异常，控制器统一处理
- 多租户数据隔离和权限校验；敏感数据安全处理
- 重要操作记录异常和日志；变更前评估影响，基础库无回退机制

## 集成与工具
- 对接外部系统使用专属接口；文件审批等复用已有基础设施组件
- 不生成数据库迁移脚本（手动迁移）；查找现有代码保持风格统一

## 变更管理与文档
- **文档分离原则**：任务管理(TODO.md)和变更记录(CHANGELOG.md)分开管理，职责清晰
- **TODO.md结构要求**：专注当前待办任务、优先级和执行计划，包含详细的技术方案和剩余工作
- **CHANGELOG.md结构要求**：开头必须有功能变更总览，使用文本格式(非表格)便于复制分享，记录所有已完成的变更历史
- **变更记录要求**：每次重要变更必须更新CHANGELOG.md文件，记录变更概要、技术细节和影响范围
- **文件清理原则**：如果文件已经没有实际执行的代码（如空的触发器框架），应删除文件避免代码冗余
- **架构重构记录**：重大架构调整需要详细记录变更前后对比，便于团队理解和维护
- **已完成任务规范**：对已完成的任务，不要列出具体代码，重点说明功能变更和影响范围

## 头部注释模板
```
/*
 * 项目：[项目/服务] | 模块：[模块/功能]
 * 功能：[主要功能简述]
 * 技术要点：[依赖注入/性能优化等]
 * 作者：zc | 创建：[YYYY-MM] | 修改：[YYYY-MM-DD] [简述]
 */
```

## PowerShell终端规范

> PowerShell 与 Bash 语法完全不同，禁止混用。严格用 PowerShell 语法。不确定时查 Get-Help 或官方文档。

<!-- 以下PowerShell终端规范仅供人工参考，AI可跳过 -->

**禁止项**：`&&`、`||`等Bash语法；`ls`、`cat`、`grep`等Bash命令；路径只能用`\`或`\\`

**正确写法**：
- 命令分步或用`;`：`cd MyApp; dotnet build; dotnet run`
- 条件处理：`if (Test-Path $path) { dotnet build }`
- 环境变量：`$env:ASPNETCORE_ENVIRONMENT = "Development"`
- 进程管理：`Stop-Process -Name "MyApp" -Force -ErrorAction SilentlyContinue`

**诊断方案**：
- `&&不是有效语句分隔符` → 用`;`或分行
- `文件被锁定` → Stop-Process
- `端口已被使用` → netstat查占用PID
- `找不到术语` → 检查拼写，必要时加`.exe`

<!-- PowerShell终端规范结束 -->