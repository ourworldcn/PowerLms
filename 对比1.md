# 会议纪要

**会议时间**： [根据转录内容推断的日期]  
**参会人员**： chong z（老张）、永昌石（老师）、云霄陈（营销）  
**会议主题**： OA费用申请单系统开发与财务接口实现

---

## 一、技术基础设施讨论

### 1.1 文件共享权限问题
- **问题描述**：会议初期，团队在通过OneDrive共享Excel文件时遇到困难，主要原因是个人账户与组织商务账户策略冲突，导致外部共享受限。
- **解决方案**：经过多次尝试，团队最终决定使用由`chong z`（老张）提供的共享文件夹进行在线协作，并现场测试了所有参会人员的编辑权限，确保了会议的顺利进行。
- **长期建议**：建议`永昌石`（老师）规划其账户体系，决定是完全迁移到组织账户还是保持个人账户独立，以避免未来的协作障碍。

---

## 二、OA费用申请单流程优化

### 2.1 基础数据与权限
- **开户行信息**：确认需要在开户行实体中增加一个`凭证字`字段，用于后续财务凭证的生成。
- **系统权限**：已新增4个与OA相关的权限节点，但尚未部署。
- **费用种类**：需要在基础数据中添加“其他费用种类”及其对应的科目代码。

### 2.2 “代申请”功能设计
- **功能定义**：允许用户（登记人）为其他同事（申请人）填写和提交费用申请单。
- **流程逻辑**：
  - 申请单的审批流程将严格按照**申请人**的审批链进行，而非登记人。
  - 系统界面需明确展示“申请人”和“登记人”，便于审批者识别。
- **权限安全**：此设计不会导致权限提升或安全漏洞，因为最终审批权仍在申请人的审批链上，审批人可以根据情况退回不合理的申请。

### 2.3 两步式财务处理流程：结算与确认
会议明确，在申请单审批流程完全结束后，需要引入一个由两步独立操作组成的财务处理环节。

**第一步：结算（由出纳操作）**
- **操作性质**：实际的付款环节。
- **核心任务**：
  - 为申请单的费用进行专业的科目分类（如：办公费、差旅费）。
  - 记录实际的`结算日期`和`支付方式`（现金/银行转账）。
  - 支持将一笔申请单拆分成多笔明细进行结算。
- **操作人员**：出纳（有权动用资金，但无权审批）。

**第二步：确认（由会计操作）**
- **操作性质**：核对与验证环节。
- **核心任务**：
  - 会计人员根据银行流水（对账单）核对出纳的结算操作是否准确无误。
  - 核对无误后，在系统中执行“确认”操作，记录`确认人`和`确认时间`。
- **操作人员**：会计（有权审核，但不能直接操作资金）。

---

## 三、财务接口系统设计

### 3.1 接口开发现状
- **已完成**：发票导入、应收计提、应付计提接口。
- **待开发**：OA申请单的收款接口和付款接口。

### 3.2 凭证生成规则
- **触发条件**：只有经过“结算”和“确认”两步操作，并被标记为“允许导入财务软件”的申请单，才能通过财务接口生成凭证。
- **凭证结构**：每一笔结算明细都将生成一条**一借一贷**的標準分錄（即2条凭证记录）。
- **凭证号**：系统自动生成，连续递增。

### 3.3 借贷分录详细设计
- **通用字段**：
  - `结算日期`、`币种`、`汇率`：取自申请单主表和明细表。
  - `摘要`：取自结算明细中填写的说明。
  - `金额`：本位币金额 = 明细金额 × 汇率。

- **付款分录（以付款为例）**：
  - **借方**：
    - `科目代码`：取自**费用种类**对应的科目代码。
    - `金额`：记录在借方金额字段。
  - **贷方**：
    - `科目代码`：取自**银行账号**（开户行）中配置的A账科目代码。
    - `金额`：记录在贷方金额字段。

- **收款分录**：借贷方科目与付款分录相反。

### 3.4 核算维度设计
凭证支持“员工”和“部门”双核算维度。
- **员工核算**：
  - `核算类别`：固定填写“员工”。
  - `员工代码`：取自员工信息中新增的“财务编码”字段。
  - `员工姓名`：员工的显示名称。
- **部门核算**：
  - `核算类别`：固定填写“部门”。
  - `部门代码`：取自基础数据中“区域部门”简单字典的Code。
  - `部门名称`：字典中的显示名称。
- **逻辑控制**：当明细中未选择员工或部门时，对应的三个核算字段均为空。

---

## 四、数据与流程配置

### 4.1 数据库与实体修改
- **员工实体**：需增加`财务编码`字段。
- **开户行实体**：需增加`凭证字`字段。
- **OA申请单实体**：需增加`确认人ID`和`确认时间`字段。

### 4.2 审批流程配置
- 需要在系统中新增两个流程编码及其显示名称：
  1. **其他费用收入申请流程**
  2. **其他费用支出申请流程**

### 4.3 接口依赖
- **获取科目代码**：
  - 费用种类科目：通过费用种类ID直接查询。
  - 银行账号科目：通过结算明细中选择的银行账号ID直接查询，无需再关联组织ID。
- **获取凭证号**：需要一个独立的接口，用于根据参数获取下一个可用的凭证号。

---

## 五、开发任务与行动项

| 模块 | 负责人 | 任务内容 | 状态 |
| --- | --- | --- | --- |
| **后端开发** | `chong z`（老张） | 1. 实现结算与确认功能接口。 | **待办** |
| | | 2. 开发OA收款与付款的财务接口。 | **待办** |
| | | 3. 在数据库实体中添加所需新字段。 | **待办** |
| | | 4. 在代码中添加两个新的审批流程编码。 | **待办** |
| **前端开发** | `云霄 陈`（营销） | 1. 开发结算操作界面。 | **待办** |
| | | 2. 开发确认操作界面。 | **待办** |
| | | 3. 实现“代申请”功能的前端逻辑与界面。 | **待办** |
| | | 4. 部署新增的4个OA权限节点。 | **待办** |
| **业务配置** | `永昌石`（老师） | 1. 完善费用种类及其科目代码的配置。 | **待办** |
| | | 2. 在简单字典中添加“区域部门”数据。 | **待办** |
| | | 3. 配置银行账号的A账科目代码和凭证字。 | **待办** |
| | | 4. 对完整的业务流程进行测试验证。 | **待办** |

---

## 六、下阶段工作安排

- **本周/近期目标**：优先完成OA费用申请单的完整流程开发，包括前后端功能实现和基础数据配置。
- **下周计划**：开始进行更复杂的“实收实付结算单”功能开发，该功能预计将调整结算单并新增约10个字段。

---

**会议决议**：
1. **确认采用“结算+确认”两步式财务处理流程。**
2. **明确了财务接口中凭证生成的一借一贷及核算维度规则。**
3. **通过了“代申请”功能的设计方案，并确认其安全性。**
4. **清晰地分配了下一阶段的开发和配置任务。**

**记录人**：AI助手  
**分发范围**：全体参会人员